-- This file is autogenerated from regen-schema.ts
create table if not exists
  idenfy_verifications (
    id bigint primary key generated always as identity not null,
    user_id text not null,
    scan_ref text unique,
    auth_token text,
    status text default 'pending' not null,
    created_time timestamp with time zone default now() not null,
    updated_time timestamp with time zone default now() not null,
    callback_data jsonb,
    overall_status text,
    fraud_status text,
    aml_status text,
    deny_reasons text
  );

-- Foreign Keys
alter table idenfy_verifications
add constraint idenfy_verifications_user_id_fkey foreign key (user_id) references users (id);

-- Row Level Security
alter table idenfy_verifications enable row level security;

-- Indexes
drop index if exists idenfy_verifications_pkey;

create unique index idenfy_verifications_pkey on public.idenfy_verifications using btree (id);

drop index if exists idenfy_verifications_user_id_idx;

create index idenfy_verifications_user_id_idx on public.idenfy_verifications using btree (user_id);

drop index if exists idenfy_verifications_scan_ref_idx;

create unique index idenfy_verifications_scan_ref_idx on public.idenfy_verifications using btree (scan_ref)
where
  (scan_ref is not null);
