-- This file is autogenerated from regen-schema.ts

CREATE TABLE IF NOT EXISTS dashboards (
  ai_importance_score numeric DEFAULT 0 NOT NULL,
  created_time timestamp with time zone DEFAULT now() NOT NULL,
  creator_avatar_url text NOT NULL,
  creator_id text NOT NULL,
  creator_name text NOT NULL,
  creator_username text NOT NULL,
  id text PRIMARY KEY DEFAULT random_alphanumeric(12) NOT NULL,
  importance_score numeric DEFAULT 0 NOT NULL,
  items jsonb DEFAULT '[]'::jsonb,
  politics_importance_score numeric DEFAULT 0 NOT NULL,
  slug text NOT NULL,
  title text NOT NULL,
  title_fts tsvector GENERATED ALWAYS AS (to_tsvector('english'::regconfig, title)) STORED,
  visibility text DEFAULT 'public'::text
);

-- Foreign Keys
ALTER TABLE dashboards ADD CONSTRAINT dashboards_creator_id_fkey FOREIGN KEY (creator_id) REFERENCES users(id);


-- Row Level Security
ALTER TABLE dashboards ENABLE ROW LEVEL SECURITY;
-- Policies
DROP POLICY IF EXISTS "Enable read access for admin" ON dashboards;
CREATE POLICY "Enable read access for admin" ON dashboards FOR SELECT TO service_role USING (true) ;

-- Indexes
DROP INDEX IF EXISTS dashboards_pkey;
CREATE UNIQUE INDEX dashboards_pkey ON public.dashboards USING btree (id);
DROP INDEX IF EXISTS idx_dashboard_slug;
CREATE UNIQUE INDEX idx_dashboard_slug ON public.dashboards USING btree (slug);

